### 重构 

​	熊杰，Martin Fowler

### 重构简单例子

​		作者对重构的基础定义 **在不改变软件可观察行为的前提下，改善其内部结构，提高其理解性，降低其修改成本。**本质就是在代码写好之后对他的设计。正常设计是在代码写好之前，但是随着时间更替，版本迭代，代码质量每况愈下，所以需要重新设计。

1，重构之前，首先检查自己是否有一套可靠的测试机制，这些测试必须有自我检验能力。

2，重构修改的幅度很小，很容易被发现。不必耗费大把时间测试。

> idea开发工具提供一些重构的方法，便捷快速。Ctrl + Alt + shift + T 重构快捷键

3，重构要提升代码的可读性。

4，思考代码的放置位置。

5，如果不需要特殊处理，尽量减少临时变量，临时变量传递容易造成问题。会助长荣昌复杂的函数。

> 利用query method 替代临时变量 Replace Temp With Query

6，将类型相关的行为搬到State模式（Replace Type Code With State/Strategy ）。运用多态替换条件语句。

7，重构节奏：测试-小修改，测试-小修改。。。



### 重构原则

什么时候重构？

- 三次法则：第一次尽管做，第二次做同样的事情会厌烦，第三次就要重构了。

- 添加功能时

- 修补错误时

- 代码评审时



间接层和重构

> 逻辑共享，分开解释意图和实现，隔离变化，封装条件逻辑。



异常抛出

> 基础框架public方法抛出基类异常，方法具有了检查的能力，可以随心所欲的定义子类。



债务：

> 未完成的重构 就是债务。过于复杂的代码造成维护和扩展的额外成本就是利息。



异味：

> 首先排除各种异味，利用工具sonar







